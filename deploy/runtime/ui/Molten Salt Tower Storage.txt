Molten Salt Tower Storage
917
515
30
GroupBox

1
7
Name
5
9
GroupBox1
X
3
6
Y
3
105
Width
3
900
Height
3
386
Caption
5
14
Storage System
Bold
2
1
Numeric

1
16
Name
5
5
Q_tes
X
3
279
Y
3
147
Width
3
100
Height
3
21
Value
1
0.000000
Mode
3
1
Format
3
0
Decimals
3
1
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
4294967295
Numeric

1
16
Name
5
23
TES_COPY_T_htf_cold_des
X
3
657
Y
3
63
Width
3
100
Height
3
21
Value
1
0.000000
Mode
3
1
Format
3
0
Decimals
3
1
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
4294967295
Numeric

1
16
Name
5
22
TES_COPY_T_htf_hot_des
X
3
657
Y
3
36
Width
3
100
Height
3
21
Value
1
0.000000
Mode
3
1
Format
3
0
Decimals
3
1
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
4294967295
Numeric

1
16
Name
5
20
TES_COPY_q_pb_design
X
3
279
Y
3
36
Width
3
100
Height
3
21
Value
1
0.000000
Mode
3
1
Format
3
0
Decimals
3
1
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
4294967295
Numeric

1
16
Name
5
16
TES_COPY_tshours
X
3
279
Y
3
63
Width
3
100
Height
3
21
Value
1
0.000000
Mode
3
1
Format
3
0
Decimals
3
1
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
4294967295
Numeric

1
16
Name
5
14
cold_tank_Thtr
X
3
657
Y
3
147
Width
3
100
Height
3
21
Value
1
0.000000
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
0
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
18
Numeric

1
16
Name
5
18
cold_tank_max_heat
X
3
657
Y
3
171
Width
3
100
Height
3
21
Value
1
0.000000
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
0
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
19
Numeric

1
16
Name
5
21
csp.pt.tes.heater_eff
X
3
657
Y
3
243
Width
3
100
Height
3
21
Value
1
0.000000
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
0
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
22
Numeric

1
16
Name
5
22
csp.pt.tes.htf_density
X
3
657
Y
3
267
Width
3
100
Height
3
21
Value
1
0.000000
Mode
3
1
Format
3
1
Decimals
3
1
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
4294967295
Numeric

1
16
Name
5
31
csp.pt.tes.init_hot_htf_percent
X
3
657
Y
3
123
Width
3
100
Height
3
21
Value
1
0.000000
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
0
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
15
Choice

1
8
Name
5
23
csp.pt.tes.storage_type
X
3
258
Y
3
120
Width
3
148
Height
3
21
Items
6
1
Two Tank
Selection
3
4294967295
TabOrder
3
1
Numeric

1
16
Name
5
24
csp.pt.tes.tank_diameter
X
3
279
Y
3
291
Width
3
100
Height
3
21
Value
1
0.000000
Mode
3
1
Format
3
0
Decimals
3
1
Prefix
5
0
Suffix
5
0
ThousandsSep
2
0
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
4
Numeric

1
16
Name
5
23
csp.pt.tes.tc_fill_dens
X
3
657
Y
3
432
Width
3
100
Height
3
21
Value
1
0.000000
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
0
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
29
Numeric

1
16
Name
5
22
csp.pt.tes.tc_fill_sph
X
3
657
Y
3
408
Width
3
100
Height
3
21
Value
1
0.000000
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
0
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
28
Choice

1
8
Name
5
23
csp.pt.tes.tc_fill_type
X
3
657
Y
3
384
Width
3
196
Height
3
21
Items
6
0
Selection
3
4294967295
TabOrder
3
27
Numeric

1
16
Name
5
6
h_tank
X
3
279
Y
3
195
Width
3
100
Height
3
21
Value
1
0.000000
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
0
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
5
Numeric

1
16
Name
5
10
h_tank_min
X
3
279
Y
3
219
Width
3
100
Height
3
21
Value
1
0.000000
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
0
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
6
Numeric

1
16
Name
5
13
hot_tank_Thtr
X
3
657
Y
3
195
Width
3
100
Height
3
21
Value
1
0.000000
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
0
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
20
Numeric

1
16
Name
5
17
hot_tank_max_heat
X
3
657
Y
3
219
Width
3
100
Height
3
21
Value
1
0.000000
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
0
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
21
Numeric

1
16
Name
5
5
nodes
X
3
657
Y
3
456
Width
3
100
Height
3
21
Value
1
0.000000
Mode
3
0
Format
3
0
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
0
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
30
GroupBox

1
7
Name
5
8
object 4
X
3
6
Y
3
12
Width
3
900
Height
3
87
Caption
5
24
System Design Parameters
Bold
2
1
Numeric

1
16
Name
5
13
q_dot_tes_est
X
3
279
Y
3
339
Width
3
100
Height
3
21
Value
1
0.000000
Mode
3
1
Format
3
0
Decimals
3
2
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
4294967295
Numeric

1
16
Name
5
12
t_ch_out_max
X
3
279
Y
3
432
Width
3
100
Height
3
21
Value
1
0.000000
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
0
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
26
Numeric

1
16
Name
5
13
t_dis_out_min
X
3
279
Y
3
408
Width
3
100
Height
3
21
Value
1
0.000000
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
0
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
25
Numeric

1
16
Name
5
10
tank_pairs
X
3
279
Y
3
267
Width
3
100
Height
3
21
Value
1
0.000000
Mode
3
0
Format
3
0
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
0
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
7
Numeric

1
16
Name
5
7
tc_void
X
3
279
Y
3
384
Width
3
100
Height
3
21
Value
1
0.000000
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
0
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
24
Numeric

1
16
Name
5
13
tes_avail_vol
X
3
279
Y
3
171
Width
3
100
Height
3
21
Value
1
0.000000
Mode
3
1
Format
3
0
Decimals
3
0
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
4294967295
Numeric

1
16
Name
5
6
u_tank
X
3
279
Y
3
315
Width
3
100
Height
3
21
Value
1
0.000000
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
0
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
10
Numeric

1
16
Name
5
8
vol_tank
X
3
279
Y
3
243
Width
3
100
Height
3
21
Value
1
0.000000
Mode
3
1
Format
3
0
Decimals
3
0
Prefix
5
0
Suffix
5
0
ThousandsSep
2
0
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
3

31
Q_tes
3
1
TES thermal capacity
MWt-hr
Thermal Energy Storage
0
8
1
1
1
1
0.000000
Default
TES_COPY_T_htf_cold_des
3
1
HTF cold temperature
°C
Thermal Energy Storage
0
8
1
1
1
1
0.000000
Default
TES_COPY_T_htf_hot_des
3
1
HTF hot temperature
°C
Thermal Energy Storage
0
8
1
1
1
1
0.000000
Default
TES_COPY_q_pb_design
3
1
Cycle thermal power
MWt
Thermal Energy Storage
0
8
1
1
1
1
0.000000
Default
TES_COPY_tshours
3
1
Hours of storage at power cycle full load
hours
Thermal Energy Storage
0
8
1
1
1
1
0.000000
Default
cold_tank_Thtr
3
1
Cold tank heater temperature set point
°C
Thermal Energy Storage
0
2
1
1
1
1
280.000000
Default
cold_tank_max_heat
3
1
Cold tank heater capacity
MWe
Thermal Energy Storage
0
2
1
1
1
1
15.000000
Default
csp.pt.tes.heater_eff
3
1
Tank heater efficiency
 
Thermal Energy Storage
0
2
1
1
1
1
0.990000
Default
csp.pt.tes.htf_calc_temp
3
1
TC
 
Thermal Energy Storage
0
8
1
1
1
1
0.000000
Default
csp.pt.tes.htf_density
3
1
HTF density
kg/m³
Thermal Energy Storage
0
8
1
1
1
1
0.000000
Default
csp.pt.tes.init_hot_htf_percent
3
1
Initial hot HTF percent
%
Thermal Energy Storage
0
2
1
1
1
1
30.000000
Default
csp.pt.tes.storage_type
3
1
Storage type
 
Thermal Energy Storage
8
Two Tank
0
1
1
1
1
0.000000
Default
csp.pt.tes.tank_diameter
3
1
Tank diameter
m
Thermal Energy Storage
0
8
1
1
1
1
20.000000
Default
csp.pt.tes.tc_fill_dens
3
1
Filler material density
kg/m³
Thermal Energy Storage
0
8
1
1
1
1
0.000000
Default
csp.pt.tes.tc_fill_sph
3
1
Filler material specific heat
kJ/kgK
Thermal Energy Storage
0
8
1
1
1
1
0.000000
Default
csp.pt.tes.tc_fill_type
3
1
Filler material
 
Thermal Energy Storage
78
Taconite|Calcium carbonate|Gravel|Marble|Limestone|Carbon steel|Sand|Quartzite
2
1
1
1
1
7.000000
Default
h_tank
3
1
Tank height
m
Thermal Energy Storage
0
2
1
1
1
1
20.906500
Default
h_tank_min
3
1
Tank fluid minimum height
m
Thermal Energy Storage
0
2
1
1
1
1
1.000000
Default
hot_tank_Thtr
3
1
Hot tank heater temperature set point
°C
Thermal Energy Storage
0
2
1
1
1
1
500.000000
Default
hot_tank_max_heat
3
1
Hot tank heater capacity
MWe
Thermal Energy Storage
0
2
1
1
1
1
30.000000
Default
nodes
3
1
Number of nodes for thermocline
 
Thermal Energy Storage
0
2
1
1
1
1
100.000000
Default
q_dot_tes_est
3
1
Estimated heat loss
MWt
Thermal Energy Storage
0
8
1
1
1
1
0.000000
Default
t_ch_out_max
3
1
Maximum charge outlet temp
°C
Thermal Energy Storage
0
2
1
1
1
1
400.000000
Default
t_dis_out_min
3
1
Minimum discharge outlet temp
°C
Thermal Energy Storage
0
2
1
1
1
1
500.000000
Default
tank_pairs
3
1
Parallel tank pairs
 
Thermal Energy Storage
0
2
1
1
1
1
1.000000
Default
tc_fill
3
1
Filler material
 
Thermal Energy Storage
0
8
1
1
1
1
8.000000
Default
tc_void
3
1
Void fraction
0..1
Thermal Energy Storage
0
2
1
1
1
1
0.250000
Default
tes_avail_vol
3
1
Available HTF volume
m³
Thermal Energy Storage
0
8
1
1
1
1
0.000000
Default
tes_type
3
1
Storage type
 
Thermal Energy Storage
0
8
1
1
1
1
1.000000
Default
u_tank
3
1
Wetted loss coefficient
Wt/m²-K
Thermal Energy Storage
0
2
1
1
1
1
1.200000
Default
vol_tank
3
1
Storage tank volume
m³
Thermal Energy Storage
0
8
1
1
1
1
0.000000
Numeric

4411
equations{ 'csp.pt.tes.tc_fill_dens' } = define() {
	return ?(${tc_fill}-1)
[
/* densities, kg/m3 */
3800,  /*1) Taconite*/
2710,  /*2) Calcium carbonate*/
2643,  /*3) Gravel*/
2680,  /*4) Marble*/
2320,  /*5) Limestone*/
7854,  /*6) Carbon Steel*/
1515,  /*7) Sand*/
2640  /*8) Quartzite*/
]; };

//equations{ 'csp.pt.tes.tank_diameter' } = define() {
//	return 2*sqrt(${vol_tank}/(${h_tank}*3.1415926*${tank_pairs})); };

//equations{ 'csp.pt.tes.htf_density' } = define() {
//	return 1; };

//equations{ 'csp.pt.tes.htf_density' } = define() {
//	return  ?${csp.pt.rec.htf_type}
//[
  /* htf type 0 - TRNSYS fluid number 17
     Salt (60% NaNO3, 40% KNO3) */
//	substance_density(17, ${csp.pt.tes.htf_calc_temp}) , 
/* htf type 1 - TRNSYS fluid number 10 
     Salt (46.5% LiF, 11.5%NaF, 42%KF)  */
//	substance_density(10, ${csp.pt.tes.htf_calc_temp}) , 
/*     user defined HTF fluid (use special sam function)  */
//	substance_userhtf(${field_fl_props},${csp.pt.tes.htf_calc_temp},"density") 
//]; };

equations{ 'csp.pt.tes.tc_fill_sph' } = define() {
	return ?${csp.pt.tes.tc_fill_type}
[
/* specific heats kJ/kgK */
0.651,  /*1) Taconite*/
0.835,  /*2) Calcium carbonate*/
1.065,  /*3) Gravel*/
0.83,  /*4) Marble*/
0.81,  /*5) Limestone*/
0.567,  /*6) Carbon Steel*/
0.8,  /*7) Sand*/
1.105  /*8) Quartzite*/
]; };

//equations{ 'csp.pt.tes.htf_calc_temp' } = define() {
//	return (${T_htf_hot_ref}+ ${T_htf_cold_des})/2; };

//equations{ 'vol_tank' } = define() {
//	return (${P_ref}*1000 / ${design_eff}
//  ) 
//* ${tshours}
// / ( (${T_htf_hot_ref}-
//	${T_htf_cold_des})
//    *  ?(${tes_type}-1) [
//		${csp.pt.tes.htf_specific_heat}*${csp.pt.tes.htf_density},
//		${tc_void}*${csp.pt.tes.htf_specific_heat}*${csp.pt.tes.htf_density}
//		+ (1-${tc_void})*${csp.pt.tes.tc_fill_sph}*${csp.pt.tes.tc_fill_dens}
			
//	]
// )
//* 3600; };

//equations{ 'csp.pt.tes.htf_specific_heat' } = define() {
//	return 1; };

//equations{ 'csp.pt.tes.htf_specific_heat' } = define() {
//	return  ?${csp.pt.rec.htf_type}
//[
  /* htf type 0 - TRNSYS fluid number 17
     Salt (60% NaNO3, 40% KNO3) */
//	substance_specific_heat(17, ${csp.pt.tes.htf_calc_temp}) ,
	 /* htf type 1 - TRNSYS fluid number 10 
     Salt (46.5% LiF, 11.5%NaF, 42%KF)  */
//	substance_specific_heat(10, ${csp.pt.tes.htf_calc_temp}) , 
	/* htf type 2 - TRNSYS fluid number 36 
     user defined   */
//	substance_userhtf(${field_fl_props},${csp.pt.tes.htf_calc_temp},"specific heat") 
//]; };


equations{ 'tes_type' } = define() {
return ${csp.pt.tes.storage_type} + 1;
};

equations{ 'tc_fill' } = define() {
return ${csp.pt.tes.tc_fill_type} + 1;
};

equations{ '$MIMO$ ui_tes_calcs' } = define()
{
	obj = ssc_create();

	ssc_var(obj, "W_dot_pb_des", ${P_ref});			//[MWe]
	ssc_var(obj, "eta_pb_des", ${design_eff});		//[-]
	ssc_var(obj, "tes_hrs", ${tshours});			//[hrs]
	ssc_var(obj, "T_HTF_hot", ${T_htf_hot_des});	//[C]
	ssc_var(obj, "T_HTF_cold", ${T_htf_cold_des});	//[C]
	ssc_var(obj, "TES_HTF_code", ${rec_htf});		//[-]
	ssc_var(obj, "TES_HTF_props", ${field_fl_props});	//[-]
	ssc_var(obj, "h_tank_min", ${h_tank_min});		//[m]
	ssc_var(obj, "h_tank", ${h_tank});				//[m]
	ssc_var(obj, "tank_pairs", ${tank_pairs});		//[-]
	ssc_var(obj, "u_tank", ${u_tank});				//[-]

	ret = ssc_exec(obj, 'ui_tes_calcs');
	
	if(ret==0)
	{
		q_tes_des = ssc_var(obj, "q_tes_des");		//[MWt-hr]
		vol_one_temp_avail = ssc_var(obj, "vol_one_temp_avail");	//[m^3]
		vol_one_temp_total = ssc_var(obj, "vol_one_temp_total");	//[m^3]
		d_tank = ssc_var(obj, "d_tank");			//[m]
		q_dot_loss = ssc_var(obj, "q_dot_loss");	//[MWt]
		dens = ssc_var(obj, "HTF_dens");			//[kg/m^3]
	}
	else
	{
		q_tes_des = 1.0/0.0;
		vol_one_temp_avail = 1.0/0.0;
		vol_one_temp_total = 1.0/0.0;
		d_tank = 1.0/0.0;
		q_dot_loss = 1.0/0.0;
		dens = 1.0/0.0;
	}
	
	${Q_tes} = q_tes_des;
	${tes_avail_vol} = vol_one_temp_avail;
	${vol_tank} = vol_one_temp_total;
	${csp.pt.tes.tank_diameter} = d_tank;
	${q_dot_tes_est} = q_dot_loss;
	${csp.pt.tes.htf_density} = dens;
	
	ssc_free( obj );	
};

// Set System Design Parameters copied from MSPT System Design
equations{ 'TES_COPY_q_pb_design' } = define(){
	return ${q_pb_design}; };

equations{ 'TES_COPY_tshours' } = define(){
	return ${tshours}; };

equations{ 'TES_COPY_T_htf_hot_des' } = define(){
	return ${T_htf_hot_des}; };
	
equations{ 'TES_COPY_T_htf_cold_des' } = define(){
	return ${T_htf_cold_des}; };








776
on_load{"Molten Salt Tower Storage"} = define() {
	on_change{"csp.pt.tes.storage_type"}();
	on_change{"is_dispatch"}();
	show("tc_void", false);
	show("t_dis_out_min", false);
	show("t_ch_out_max", false);
	show("csp.pt.tes.tc_fill_type", false);
	show("csp.pt.tes.tc_fill_sph", false);
	show("csp.pt.tes.tc_fill_dens", false);
	show("nodes", false);

};

on_change{"csp.pt.tes.storage_type"} = define() {
	st = value("csp.pt.tes.storage_type");
	
	enable( "h_tank_min", st==0 );
	enable( "hot_tank_Thtr", st==0 );
	enable( 'hot_tank_max_heat', st==0 );
	
	enable( "tc_void", st==1 );
	enable( "csp.pt.tes.f_tc_cold_init", st==1 );
	enable( "csp.pt.tes.tc_fill_type", st==1 );
	enable( "nodes", st==1 );
	enable( "t_dis_out_min", st==1 );
	enable( "t_ch_out_max", st==1 );
};

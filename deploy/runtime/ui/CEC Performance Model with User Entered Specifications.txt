CEC Performance Model with User Entered Specifications
1288
708
37
Numeric

1
16
Name
5
17
6par_aisc_display
X
3
330
Y
3
387
Width
3
100
Height
3
21
Value
1
0.000000
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
0
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
10
Choice

1
8
Name
5
15
6par_aisc_units
X
3
432
Y
3
387
Width
3
64
Height
3
21
Items
6
2
A/°C
%/°C
Selection
3
0
TabOrder
3
0
Numeric

1
16
Name
5
9
6par_area
X
3
255
Y
3
75
Width
3
100
Height
3
21
Value
1
0.000000
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
0
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
3
Numeric

1
16
Name
5
37
6par_bifacial_ground_clearance_height
X
3
420
Y
3
180
Width
3
90
Height
3
24
Value
1
0.000000
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
4294967295
Numeric

1
16
Name
5
33
6par_bifacial_transmission_factor
X
3
162
Y
3
177
Width
3
90
Height
3
24
Value
1
0.000000
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
4294967295
Numeric

1
16
Name
5
16
6par_bifaciality
X
3
162
Y
3
204
Width
3
90
Height
3
24
Value
1
0.000000
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
4294967295
Numeric

1
16
Name
5
17
6par_bvoc_display
X
3
330
Y
3
363
Width
3
100
Height
3
21
Value
1
0.000000
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
0
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
9
Choice

1
8
Name
5
15
6par_bvoc_units
X
3
432
Y
3
363
Width
3
64
Height
3
21
Items
6
2
V/°C
%/°C
Selection
3
0
TabOrder
3
0
Choice

1
8
Name
5
13
6par_celltech
X
3
255
Y
3
51
Width
3
181
Height
3
21
Items
6
6
monoSi
multiSi
CdTe
CIS
CIGS
Amorphous
Selection
3
1
TabOrder
3
2
TextEntry

1
10
Name
5
18
6par_data_filename
X
3
381
Y
3
660
Width
3
539
Height
3
24
Text
5
0
Editable
2
0
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
4294967295
Numeric

1
16
Name
5
9
6par_gpmp
X
3
330
Y
3
411
Width
3
100
Height
3
21
Value
1
0.000000
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
0
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
11
Numeric

1
16
Name
5
8
6par_imp
X
3
330
Y
3
291
Width
3
100
Height
3
21
Value
1
0.000000
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
0
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
6
CheckBox

1
8
Name
5
16
6par_is_bifacial
X
3
57
Y
3
147
Width
3
147
Height
3
24
Caption
5
20
Modules are bifacial
State
2
0
TabOrder
3
4294967295
Numeric

1
16
Name
5
8
6par_isc
X
3
330
Y
3
339
Width
3
100
Height
3
21
Value
1
0.000000
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
0
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
8
TextEntry

1
10
Name
5
16
6par_module_name
X
3
255
Y
3
27
Width
3
259
Height
3
21
Text
5
30
Generic polycrystalline module
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
1
Choice

1
8
Name
5
13
6par_mounting
X
3
234
Y
3
513
Width
3
280
Height
3
21
Items
6
0
Selection
3
4294967295
TabOrder
3
14
Numeric

1
16
Name
5
10
6par_mpeff
X
3
699
Y
3
54
Width
3
100
Height
3
21
Value
1
0.000000
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
0
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
16
Numeric

1
16
Name
5
9
6par_nser
X
3
330
Y
3
435
Width
3
100
Height
3
21
Value
1
0.000000
Mode
3
0
Format
3
0
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
0
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
12
Numeric

1
16
Name
5
8
6par_pmp
X
3
699
Y
3
30
Width
3
100
Height
3
21
Value
1
0.000000
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
0
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
15
Choice

1
8
Name
5
13
6par_standoff
X
3
234
Y
3
489
Width
3
280
Height
3
21
Items
6
0
Selection
3
4294967295
TabOrder
3
13
Numeric

1
16
Name
5
10
6par_tnoct
X
3
255
Y
3
99
Width
3
100
Height
3
21
Value
1
0.000000
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
0
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
4
Numeric

1
16
Name
5
8
6par_vmp
X
3
330
Y
3
267
Width
3
100
Height
3
21
Value
1
0.000000
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
0
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
5
Numeric

1
16
Name
5
8
6par_voc
X
3
330
Y
3
315
Width
3
100
Height
3
21
Value
1
0.000000
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
0
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
7
GroupBox

1
7
Name
5
9
GroupBox1
X
3
9
Y
3
9
Width
3
533
Height
3
233
Caption
5
19
General Information
Bold
2
1
GroupBox

1
7
Name
5
9
GroupBox2
X
3
6
Y
3
249
Width
3
533
Height
3
218
Caption
5
25
Electrical Specifications
Bold
2
1
GroupBox

1
7
Name
5
11
GroupBox213
X
3
9
Y
3
633
Width
3
941
Height
3
66
Caption
5
16
Save / Load Data
Bold
2
1
GroupBox

1
7
Name
5
9
GroupBox3
X
3
9
Y
3
471
Width
3
533
Height
3
77
Caption
5
22
Mounting Configuration
Bold
2
1
GroupBox

1
7
Name
5
9
GroupBox4
X
3
549
Y
3
9
Width
3
401
Height
3
80
Caption
5
42
Nominal Maximum Power Point Ratings at STC
Bold
2
1
GroupBox

1
7
Name
5
9
GroupBox5
X
3
552
Y
3
108
Width
3
401
Height
3
419
Caption
5
34
Current-Voltage (I-V) Curve at STC
Bold
2
1
Button

1
7
Name
5
14
btnCalcIVCurve
X
3
687
Y
3
135
Width
3
131
Height
3
21
Caption
5
18
Calculate and plot
TabOrder
3
17
Button

1
7
Name
5
15
btnLoad6parData
X
3
186
Y
3
660
Width
3
153
Height
3
24
Caption
5
22
Load data from file...
TabOrder
3
4294967295
Button

1
7
Name
5
15
btnSave6parData
X
3
27
Y
3
660
Width
3
153
Height
3
24
Caption
5
20
Save data to file...
TabOrder
3
4294967295
Divider

1
9
Name
5
15
dividerBifacial
X
3
54
Y
3
129
Width
3
453
Height
3
16
Orientation
3
0
Colour
4
120
120
120
255
Caption
5
23
Bifacial Specifications
Bold
2
1
GroupBox

1
7
Name
5
5
group
X
3
9
Y
3
549
Width
3
942
Height
3
87
Caption
5
10
References
Bold
2
1
Plot

1
5
Name
5
6
ivplot
X
3
561
Y
3
168
Width
3
381
Height
3
351
Hyperlink

1
8
Name
5
9
object 14
X
3
27
Y
3
609
Width
3
915
Height
3
21
Caption
5
51
Performance Model Documentation page on SAM website
URL
5
32
https://sam.nrel.gov/performance
TabOrder
3
4294967295
Label

1
12
Name
5
8
object 7
X
3
27
Y
3
564
Width
3
915
Height
3
42
Caption
5
181
For information about the CEC module model inputs, see Help. For details about the model implementation, see Gilman (2015) on the SAM website's Performance Model Documentation page:
TextColour
4
0
0
0
255
Bold
2
0
FontSize
3
0
WordWrap
2
1
AlignRight
2
0
AlignTop
2
1

25
6par_aisc
3
1
Temperature coefficient of Isc
 
PV Module (CEC User Specified)
0
10
1
1
1
1
0.004000
Numeric
6par_aisc_display
3
1
Temperature coefficient of Isc
 
PV Module (CEC User Specified)
0
0
1
1
1
1
0.004000
Default
6par_aisc_units
3
1
aIsc Temp Coeff Units
 
PV Module (CEC User Specified)
9
A/°C|%/°C
1
1
1
1
1
0.000000
Choice
6par_area
3
1
Module area
m²
PV Module (CEC User Specified)
0
2
1
1
1
1
1.300000
Numeric
6par_bifacial_ground_clearance_height
3
1
Ground clearance height
m
PV Module (CEC User Specified)
0
2
1
1
1
1
1.000000
Numeric
6par_bifacial_transmission_factor
3
1
Transmission Fraction
0-1
PV Module (CEC User Specified)
0
2
1
1
1
1
0.013000
Default
6par_bifaciality
3
1
Bifaciality
0-1
PV Module (CEC User Specified)
0
2
1
1
1
1
0.650000
Default
6par_bvoc
3
1
Temperature coefficient of Voc
 
PV Module (CEC User Specified)
0
10
1
1
1
1
-0.110000
Numeric
6par_bvoc_display
3
1
Temperature coefficient of Voc
 
PV Module (CEC User Specified)
0
0
1
1
1
1
-0.110000
Default
6par_bvoc_units
3
1
bVoc Temp Coeff Units
 
PV Module (CEC User Specified)
9
V/°C|%/°C
1
1
1
1
1
0.000000
Choice
6par_celltech
3
1
Cell type
 
PV Module (CEC User Specified)
38
monoSi|multiSi|CdTe|CIS|CIGS|Amorphous
0
1
1
1
1
1.000000
Choice
6par_data_filename
3
4
 
 
 
0
0
1
4
0
TextEntry
6par_gpmp
3
1
Temperature coefficient of max. power point
%/°C
PV Module (CEC User Specified)
0
2
1
1
1
1
-0.410000
Numeric
6par_imp
3
1
Maximum power point current (Imp)
A
PV Module (CEC User Specified)
0
2
1
1
1
1
6.000000
Numeric
6par_is_bifacial
3
1
Use Bifacial Modules
 
PV Module (CEC User Specified)
0
1
1
1
1
1
0.000000
Default
6par_isc
3
1
Short circuit current (Isc)
A
PV Module (CEC User Specified)
0
2
1
1
1
1
7.000000
Numeric
6par_module_name
3
4
Module description
 
PV Module (CEC User Specified)
0
0
1
4
38
Generic polycrystalline silicon module
TextEntry
6par_mounting
3
1
Approximate installation height
 
PV Module (CEC User Specified)
70
One story building height or lower|Two story building height or higher
2
1
1
1
1
0.000000
Choice
6par_mpeff
3
1
Efficiency
%
PV Module (CEC User Specified)
0
8
1
1
1
1
0.000000
Numeric
6par_nser
3
1
Number of cells in series
 
PV Module (CEC User Specified)
0
2
1
1
1
1
60.000000
Numeric
6par_pmp
3
1
Power
Wdc
PV Module (CEC User Specified)
0
8
1
1
1
1
0.000000
Numeric
6par_standoff
3
1
Standoff height
 
PV Module (CEC User Specified)
112
Building integrated|Greater than 3.5 in|2.5-3.5 in|1.5-2.5 in|0.5-1.5 in|Less than 0.5 in|Ground or rack mounted
2
1
1
1
1
6.000000
Choice
6par_tnoct
3
1
Nominal operating cell temperature
°C
PV Module (CEC User Specified)
0
2
1
1
1
1
46.000000
Numeric
6par_vmp
3
1
Maximum power point voltage (Vmp)
V
PV Module (CEC User Specified)
0
2
1
1
1
1
30.000000
Numeric
6par_voc
3
1
Open circuit voltage (Voc)
V
PV Module (CEC User Specified)
0
2
1
1
1
1
37.000000
Numeric

456
equations{ '6par_mpeff' } = define() {
	return 100.0*${6par_vmp}*${6par_imp}/${6par_area}/1000.0; };

equations{ '6par_pmp' } = define() {
	return ${6par_vmp}*${6par_imp}; };
	
equations{ '6par_bvoc' } = define() {
	return ?${6par_bvoc_units} [${6par_bvoc_display}, 
	0.01 * ${6par_bvoc_display} * ${6par_voc} ]; };
	
equations{ '6par_aisc' } = define() {
	return ?${6par_aisc_units} [${6par_aisc_display}, 
	0.01 * ${6par_aisc_display} * ${6par_isc} ]; };
3362
on_load{'CEC Performance Model with User Entered Specifications'} = define() {

	enable_bifacial();
};

on_change{'6par_is_bifacial'} = define(){
	enable_bifacial();
};

on_change{'btnCalcIVCurve'} = define() {

	//calculate inputs
	celltype= ?${6par_celltech}[
		'monoSi', 'multiSi/polySi', 'cdte', 'cis', 'cigs', 'amorphous'];
	
	//call 6parsolve module
	obj = ssc_create();
	ssc_var(obj, 'celltype', celltype);
	ssc_var(obj, 'Vmp', ${6par_vmp});
	ssc_var(obj, 'Imp', ${6par_imp});
	ssc_var(obj, 'Voc', ${6par_voc});
	ssc_var(obj, 'Isc', ${6par_isc});
	ssc_var(obj, 'alpha_isc', ${6par_aisc});
	ssc_var(obj, 'beta_voc', ${6par_bvoc});
	ssc_var(obj, 'gamma_pmp', ${6par_gpmp});
	ssc_var(obj, 'Nser', ${6par_nser});
	ssc_var(obj, 'Tref', 25);
	result= ssc_exec(obj, '6parsolve', {'show_dialog'=true, 'hold_dialog'=true} );
	if(result != 0)
	{
		msgbox('Failed to solve for module coefficients. Please check your inputs.');
		return;
	}
	a = ssc_var(obj, 'a');
	Il = ssc_var(obj, 'Il');
	Io = ssc_var(obj, 'Io');
	Rs = ssc_var(obj, 'Rs');
	Rsh = ssc_var(obj, 'Rsh');
	
	ssc_free(obj);
	
	//allocations and size of array
	array_size = 602;
	interval = ${6par_vmp}/300;
	x= alloc(array_size); y= alloc(array_size);
	//First Point- Short Circuit
	x[0]= 0; y[0]= ${6par_isc};
	i=1;
	//Before Max Power Point (MPP)
	while(i<300)
	{
		Vcec= i*interval;
		Icec= current_at_voltage_cec(Vcec, Il, Io, Rs, a, Rsh, ${6par_imp});
		x[i] = Vcec; y[i] = Icec;
		i= i + 1;
	}
	//MPP
	x[i] = ${6par_vmp}; y[i] = ${6par_imp};
	i= i + 1;
	//After MPP
	interval = (${6par_voc} - ${6par_vmp})/300;
	while(i<601)
	{
		Vcec = ${6par_vmp} + (i-300) * interval;
		Icec= current_at_voltage_cec(Vcec, Il, Io, Rs, a, Rsh, ${6par_imp});
		x[i] = Vcec; y[i] = Icec;
		i= i + 1;
	}
	//Last Point- Open Circuit
	x[i] = ${6par_voc}; y[i] = 0;
	//Make the plot
	setplot("ivplot");
	clearplot("ivplot");
	plotopt({"title"=${6par_module_name},"popup"=true,"backcolor"=[255,255,255],"legend"=false});
	plot(x,y,{"thick"=2, "scale"=true,"color"=[200,100,100]});
	axis('x1', {'label'='Module Voltage (Volts)', 'min'=0, 'max'=ceil(${6par_voc})});
	axis('y1', {'label'='Module Current (Amps)', 'min'=0, 'max'= (max(y) + 0.5)});
	
};


on_change{'btnSave6parData'} = define() {
	logmsg('running btnSave6parData');
	file = choose_file( '', 'Save CEC Module Performance Data As', 
		'Data Files (*.csv)|*.csv', true);
		
	if ( file != '' ) {
		file = replace(file, '\\', '/');
		if (group_write('PV Module (CEC User Specified)',file))
		{	
			value( '6par_data_filename', file );
			msgbox("Data saved! \n");
		}
		else
		{
			value( '6par_data_filename', "" );
			msgbox("Data save failed! \n");
		}
	}
};

on_change{'btnLoad6parData'} = define() {
	logmsg('running btnLoad6parData');
	file = choose_file( '', 'Open CEC Module Performance File', 
		'Data Files (*.csv)|*.csv');
		
	if ( file != '' ) {
		file = replace(file, '\\', '/');
		if (group_read('PV Module (CEC User Specified)',file))
		{	
			value( '6par_data_filename', file );
			msgbox("Data loaded! \n");
		}
		else
		{
			value( '6par_data_filename', "" );
			msgbox("Data load failed! \n");
		}
	}
};

function enable_bifacial()
{
	enable('6par_bifaciality', value('6par_is_bifacial'));
	enable('6par_bifacial_transmission_factor', value('6par_is_bifacial'));
	enable('6par_bifacial_ground_clearance_height', value('6par_is_bifacial'));
}

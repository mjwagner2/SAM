Financial LCOE Calculator
871
712
37
SchedNumeric

1
11
Name
5
19
c_construction_cost
X
3
405
Y
3
501
Width
3
90
Height
3
24
Label
5
5
Value
UseSchedule
2
1
ScheduleOnly
2
0
FixedLength
3
4294967295
Description
5
0
TabOrder
3
14
Numeric

1
16
Name
5
23
c_construction_interest
X
3
405
Y
3
528
Width
3
90
Height
3
24
Value
1
0.000000
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
15
Numeric

1
16
Name
5
14
c_debt_percent
X
3
405
Y
3
393
Width
3
90
Height
3
24
Value
1
0.000000
Mode
3
1
Format
3
1
Decimals
3
2
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
10
SchedNumeric

1
11
Name
5
23
c_depreciation_schedule
X
3
405
Y
3
474
Width
3
90
Height
3
24
Label
5
5
Value
UseSchedule
2
1
ScheduleOnly
2
0
FixedLength
3
4294967295
Description
5
0
TabOrder
3
13
Numeric

1
16
Name
5
15
c_equity_return
X
3
405
Y
3
366
Width
3
90
Height
3
24
Value
1
0.000000
Mode
3
1
Format
3
1
Decimals
3
2
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
9
Numeric

1
16
Name
5
11
c_inflation
X
3
405
Y
3
339
Width
3
90
Height
3
24
Value
1
0.000000
Mode
3
1
Format
3
1
Decimals
3
2
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
8
Numeric

1
16
Name
5
10
c_lifetime
X
3
405
Y
3
312
Width
3
90
Height
3
24
Value
1
0.000000
Mode
3
0
Format
3
0
Decimals
3
2
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
7
Numeric

1
16
Name
5
23
c_nominal_interest_rate
X
3
405
Y
3
420
Width
3
90
Height
3
24
Value
1
0.000000
Mode
3
1
Format
3
1
Decimals
3
2
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
11
Numeric

1
16
Name
5
10
c_tax_rate
X
3
405
Y
3
447
Width
3
90
Height
3
24
Value
1
0.000000
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
12
Numeric

1
16
Name
5
12
capital_cost
X
3
570
Y
3
582
Width
3
90
Height
3
24
Value
1
0.000000
Mode
3
1
Format
3
0
Decimals
3
2
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
4294967295
Numeric

1
16
Name
5
17
fixed_charge_rate
X
3
717
Y
3
312
Width
3
90
Height
3
24
Value
1
0.000000
Mode
3
1
Format
3
0
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
4294967295
Numeric

1
16
Name
5
20
fixed_operating_cost
X
3
570
Y
3
609
Width
3
90
Height
3
24
Value
1
0.000000
Mode
3
1
Format
3
0
Decimals
3
2
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
4294967295
Label

1
12
Name
5
16
lbl_fcr_equation
X
3
570
Y
3
339
Width
3
240
Height
3
24
Caption
5
33
FCR = CRF ⋅ PFF ⋅ CFF (see below)
TextColour
4
0
0
0
255
Bold
2
0
FontSize
3
0
WordWrap
2
1
AlignRight
2
1
AlignTop
2
1
Hyperlink

1
8
Name
5
9
object 14
X
3
21
Y
3
93
Width
3
468
Height
3
24
Caption
5
62
NREL Annual Technology Baseline and Standard Scenarios website
URL
5
52
http://www.nrel.gov/analysis/data_tech_baseline.html
TabOrder
3
4294967295
Divider

1
9
Name
5
9
object 22
X
3
12
Y
3
561
Width
3
837
Height
3
16
Orientation
3
0
Colour
4
120
120
120
255
Caption
5
16
Reference Values
Bold
2
1
Divider

1
9
Name
5
11
object 2211
X
3
12
Y
3
267
Width
3
837
Height
3
16
Orientation
3
0
Colour
4
120
120
120
255
Caption
5
21
Financial Assumptions
Bold
2
1
Divider

1
9
Name
5
11
object 2219
X
3
18
Y
3
117
Width
3
837
Height
3
16
Orientation
3
0
Colour
4
120
120
120
255
Caption
5
27
Capital and Operating Costs
Bold
2
1
GroupBox

1
7
Name
5
8
object 4
X
3
9
Y
3
6
Width
3
850
Height
3
693
Caption
5
15
LCOE Calculator
Bold
2
1
Label

1
12
Name
5
8
object 7
X
3
15
Y
3
27
Width
3
831
Height
3
63
Caption
5
375
The fixed-charge rate method of calculating the levelized cost of energy simplifies time-dependent calculations and is appropriate for market-level analysis such as for the NREL Annual Technology Baseline, or for very preliminary project analysis. The cash flow method of SAM's other financial models is more suitable for more detailed project analysis. See Help for details.
TextColour
4
0
0
0
255
Bold
2
0
FontSize
3
0
WordWrap
2
1
AlignRight
2
0
AlignTop
2
1
Label

1
12
Name
5
10
object 727
X
3
15
Y
3
216
Width
3
195
Height
3
24
Caption
5
29
Fixed operating cost (annual)
TextColour
4
0
0
0
255
Bold
2
0
FontSize
3
0
WordWrap
2
0
AlignRight
2
1
AlignTop
2
0
Label

1
12
Name
5
9
object 73
X
3
30
Y
3
666
Width
3
321
Height
3
24
Caption
5
47
LCOE = ( FCR ⋅ CC + FOC ) / Annual Energy + VOC
TextColour
4
0
0
0
255
Bold
2
0
FontSize
3
0
WordWrap
2
1
AlignRight
2
1
AlignTop
2
1
Label

1
12
Name
5
10
object 735
X
3
33
Y
3
189
Width
3
177
Height
3
24
Caption
5
12
Capital cost
TextColour
4
0
0
0
255
Bold
2
0
FontSize
3
0
WordWrap
2
0
AlignRight
2
1
AlignTop
2
0
Numeric

1
16
Name
5
24
ui_capital_cost_capacity
X
3
351
Y
3
189
Width
3
90
Height
3
24
Value
1
0.000000
Mode
3
1
Format
3
0
Decimals
3
2
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
3
Numeric

1
16
Name
5
21
ui_capital_cost_fixed
X
3
213
Y
3
189
Width
3
90
Height
3
24
Value
1
0.000000
Mode
3
1
Format
3
0
Decimals
3
2
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
1
Numeric

1
16
Name
5
7
ui_cfin
X
3
252
Y
3
636
Width
3
90
Height
3
24
Value
1
0.000000
Mode
3
1
Format
3
0
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
4294967295
RadioChoice

1
10
Name
5
20
ui_cost_input_option
X
3
198
Y
3
162
Width
3
300
Height
3
24
Selection
3
0
Items
6
2
Enter costs in $
Enter costs in $/kW
ShowCaptions
2
1
Horizontal
2
1
TabOrder
3
4294967295
Numeric

1
16
Name
5
6
ui_crf
X
3
252
Y
3
582
Width
3
90
Height
3
24
Value
1
0.000000
Mode
3
1
Format
3
0
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
4294967295
RadioChoice

1
10
Name
5
19
ui_fcr_input_option
X
3
96
Y
3
285
Width
3
516
Height
3
24
Selection
3
0
Items
6
2
Enter fixed charge rate
Calculate fixed charge rate
ShowCaptions
2
1
Horizontal
2
1
TabOrder
3
4294967295
Numeric

1
16
Name
5
20
ui_fixed_charge_rate
X
3
159
Y
3
312
Width
3
90
Height
3
24
Value
1
0.000000
Mode
3
1
Format
3
1
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
6
Label

1
12
Name
5
14
ui_lbl_cff_msg
X
3
600
Y
3
372
Width
3
237
Height
3
144
Caption
5
0
TextColour
4
255
0
0
255
Bold
2
0
FontSize
3
0
WordWrap
2
1
AlignRight
2
0
AlignTop
2
1
Numeric

1
16
Name
5
26
ui_operating_cost_capacity
X
3
351
Y
3
216
Width
3
90
Height
3
24
Value
1
0.000000
Mode
3
1
Format
3
0
Decimals
3
2
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
4
Numeric

1
16
Name
5
23
ui_operating_cost_fixed
X
3
213
Y
3
216
Width
3
90
Height
3
24
Value
1
0.000000
Mode
3
1
Format
3
0
Decimals
3
2
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
2
Numeric

1
16
Name
5
7
ui_pfin
X
3
252
Y
3
609
Width
3
90
Height
3
24
Value
1
0.000000
Mode
3
1
Format
3
0
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
4294967295
Numeric

1
16
Name
5
18
ui_system_capacity
X
3
351
Y
3
135
Width
3
90
Height
3
24
Value
1
0.000000
Mode
3
1
Format
3
0
Decimals
3
2
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
4294967295
Numeric

1
16
Name
5
26
ui_variable_operating_cost
X
3
291
Y
3
246
Width
3
90
Height
3
24
Value
1
0.000000
Mode
3
1
Format
3
0
Decimals
3
4
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
5
Numeric

1
16
Name
5
7
ui_wacc
X
3
570
Y
3
663
Width
3
90
Height
3
24
Value
1
0.000000
Mode
3
1
Format
3
0
Decimals
3
3
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
4294967295
Numeric

1
16
Name
5
23
variable_operating_cost
X
3
570
Y
3
636
Width
3
90
Height
3
24
Value
1
0.000000
Mode
3
1
Format
3
0
Decimals
3
2
Prefix
5
0
Suffix
5
0
ThousandsSep
2
1
Editable
2
1
ForeColour
4
0
0
0
255
BackColour
4
255
255
255
255
TabOrder
3
4294967295

29
c_construction_cost
3
2
Annual cost during construction
% of capital cost
LCOE Calculator
0
2
1
2
1
1
0.000000
SchedNumeric
c_construction_duration
3
1
Construction period
years
LCOE Calculator
0
2
1
1
1
1
0.000000
Default
c_construction_interest
3
1
Nominal construction interest rate
%/year
LCOE Calculator
0
2
1
1
1
1
0.000000
Default
c_debt_percent
3
1
Project term debt
% of capital cost
LCOE Calculator
0
2
1
1
1
1
0.000000
Default
c_depreciation_schedule
3
2
Depreciation schedule
% of capital cost
LCOE Calculator
0
2
1
2
1
6
20.000000 32.000000 19.200001 11.520000 11.520000 5.760000 

SchedNumeric
c_equity_return
3
1
Internal rate of return (nominal)
%/year
LCOE Calculator
0
2
1
1
1
1
0.000000
Default
c_inflation
3
1
Inflation rate
%/year
LCOE Calculator
0
2
1
1
1
1
0.000000
Default
c_lifetime
3
1
Analysis period
years
LCOE Calculator
0
2
1
1
1
1
0.000000
Default
c_nominal_interest_rate
3
1
Nominal debt interest rate
%/year
LCOE Calculator
0
2
1
1
1
1
0.000000
Default
c_tax_rate
3
1
Effective tax rate
%/year
LCOE Calculator
0
2
1
1
1
1
0.000000
Default
capital_cost
3
1
Capital cost (CC)
$
LCOE Calculator
0
8
1
1
1
1
0.000000
Default
fixed_charge_rate
3
1
Fixed charge rate (FCR)
 
LCOE Calculator
0
8
1
1
1
1
0.000000
Default
fixed_operating_cost
3
1
Fixed operating cost (FOC)
$
LCOE Calculator
0
8
1
1
1
1
0.000000
Default
ui_capital_cost_capacity
3
1
Capital cost
$/kW
LCOE Calculator
0
3
1
1
1
1
0.000000
Default
ui_capital_cost_fixed
3
1
Capital cost
$
LCOE Calculator
0
3
1
1
1
1
0.000000
Default
ui_cfin
3
1
Construction financing factor (CFF)
 
LCOE Calculator
0
8
1
1
1
1
0.000000
Default
ui_cost_input_option
3
1
Cost input option (0=$,1=$/kW)
 
LCOE Calculator
36
Enter costs in $|Enter costs in $/kW
3
1
1
1
1
0.000000
Default
ui_crf
3
1
Capital recovery factor (CRF)
 
LCOE Calculator
0
8
1
1
1
1
0.000000
Default
ui_fcr_input_option
3
1
FCR input option (0=FCR,1=details)
 
LCOE Calculator
0
3
1
1
1
1
0.000000
Default
ui_fixed_charge_rate
3
1
Fixed charge rate (real)
 
LCOE Calculator
0
2
1
1
1
1
1.000000
Default
ui_ireal
3
1
Real debt interest rate
 
LCOE Calculator
0
8
1
1
1
1
0.000000
Default
ui_lbl_cff_msg
3
4
Construction financing message
 
LCOE Calculator
0
1
1
4
0
Default
ui_operating_cost_capacity
3
1
Operating cost
$/kW-yr
LCOE Calculator
0
3
1
1
1
1
0.000000
Default
ui_operating_cost_fixed
3
1
Operating cost
$
LCOE Calculator
0
3
1
1
1
1
0.000000
Default
ui_pfin
3
1
Project financing factor (PFF)
 
LCOE Calculator
0
8
1
1
1
1
0.000000
Default
ui_system_capacity
3
1
System capacity
kW
LCOE Calculator
0
8
1
1
1
1
0.000000
Default
ui_variable_operating_cost
3
1
Variable operating cost
$/kWh
LCOE Calculator
0
2
1
1
1
1
0.000000
Default
ui_wacc
3
1
WACC (for reference only)
 
LCOE Calculator
0
8
1
1
1
1
0.000000
Default
variable_operating_cost
3
1
Variable operating cost (VOC)
$/kWh
LCOE Calculator
0
8
1
1
1
1
0.000000
Default

1770


equations{ 'ui_system_capacity' } = define() {
  return ${system_capacity}; 
};

equations{ 'fixed_operating_cost' } = define() {
  if (${ui_cost_input_option}==0) 
    return ${ui_operating_cost_fixed};
  else 
    return ${system_capacity}*${ui_operating_cost_capacity}; 
};

equations{ 'variable_operating_cost' } = define() {
  return ${ui_variable_operating_cost};
};

equations{ 'capital_cost' } = define() {
  if (${ui_cost_input_option}==0)
    return ${ui_capital_cost_fixed};
  else  
    return ${system_capacity}*${ui_capital_cost_capacity}; 
};

equations{ '$MIMO$ fixed_charge_rate_calculator' } = define() {
  if ( ${ui_fcr_input_option}==0 )
    ${fixed_charge_rate} = ${ui_fixed_charge_rate};
  else {
    i = ${c_inflation}/100;
    nroe = ${c_equity_return}/100;
    rroe = (1+nroe)/(1+i)-1; // real return on equity
    df = ${c_debt_percent}/100; 
    inom =${c_nominal_interest_rate}/100;
    ireal = (1+inom)/(1+i)-1; // real interest rate 
    tr = ${c_tax_rate}/100;
    wacc = ((1+((1-df)*((1+rroe)*(1+i)-1))+ 
            (df*((1+ireal)*(1+i)-1)*(1-tr)))/(1+i))-1; // real wacc
	${ui_wacc} = wacc;
    t = ${c_lifetime};
    crf =  wacc/(1-(1/(1+wacc)^t)); // real crf
    dep = ${c_depreciation_schedule};
    arr = alloc(#dep);
    for (n=0;n<#arr;n++) 
      arr[n]=dep[n]/100*(1/((1+wacc)*(1+i))^(n+1));
    pvd = sum(arr);
    pfin = (1-tr*pvd)/(1-tr);
    ccon = ${c_construction_cost};
    cint = ${c_construction_interest}/100;
    arr = alloc(#ccon);
    for (n=0;n<#arr;n++) 
      arr[n]=ccon[n]/100*(1+(1-tr)*((1+cint)^(n+0.5)-1));
    cfin=sum(arr);
    fcr = crf*pfin*cfin;
    ${ui_crf} = crf;
    ${ui_pfin} = pfin;
    ${ui_cfin} = cfin;
    ${ui_wacc} = wacc;
    ${ui_ireal} = ireal;
    ${fixed_charge_rate} = fcr;
  }
};
1586
on_load{"Financial LCOE Calculator"} = define()
{
  on_change{'ui_cost_input_option'}();
  on_change{'ui_fcr_input_option'}();
  on_change{'c_construction_cost'}();
  cfin_is_zero_check();
};

on_change{'ui_cost_input_option'} = define()
{
  fixed = ( value('ui_cost_input_option') == 0 );
  
  enable( 'ui_capital_cost_fixed', fixed );
  enable( 'ui_operating_cost_fixed', fixed );
  
  enable( 'ui_capital_cost_capacity', !fixed );
  enable( 'ui_operating_cost_capacity', !fixed );
};

on_change{'ui_fcr_input_option'} = define()
{
  calculator = ( value('ui_fcr_input_option') == 1 );
  
  enable( 'c_lifetime', calculator );
  enable( 'c_inflation', calculator );
  enable( 'c_real_discount_rate', calculator );
  enable( 'c_equity_return', calculator );
  enable( 'c_debt_percent', calculator );
  enable( 'c_nominal_interest_rate', calculator );
  enable( 'c_tax_rate', calculator );
  enable( 'c_depreciation_schedule', calculator );
  enable( 'c_construction_cost', calculator );
  enable( 'c_construction_interest', calculator );
  enable( 'ui_crf', calculator );
  enable( 'ui_pfin', calculator );
  enable( 'ui_cfin', calculator );

  enable( 'ui_fixed_charge_rate', !calculator );
  
};

on_change{'c_construction_cost'} = define() { cfin_is_zero_check(); };
function cfin_is_zero_check()
{
	msg = '';
	if ( value('ui_cfin') == 0 ) 
		msg = 'CFF=0. To remove construction financing from your analysis, set the annual cost during constrution to 100% instead of zero, and set the nominal construction interest rate to zero.';
	property( 'ui_lbl_cff_msg', 'Caption', msg );
}

